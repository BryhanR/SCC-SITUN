<!DOCTYPE html>
<html ng-app = "app">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Busqueda</title>
  
  
  <!----Calendario-
  <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet">
   >
   
   
  <link rel="stylesheet" href="\..\stylesheets\bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <script src="\..\javascripts\bootstrap.min.js"></script>
  <link href="\..\stylesheets\bootstrap-datetimepicker.min.css" rel="stylesheet">
  <script type="text/javascript"src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
    <!--script type="text/javascript"src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script->
    <script type="text/javascript"src="\..\javascripts\bootstrap-datetimepicker.min.js"></script>

	-->
	<script src="\..\javascripts\new\jquery-1.12.2.js"></script>
<script src="\..\javascripts\new\moment-2.15.1.js"></script>

<script src="\..\javascripts\new\bootstrap-3-3-7.min.js"></script>

<link rel="stylesheet" href="\..\javascripts\new\bootstrap-3-3-7.min.css">


<script src="\..\javascripts\new\bootstrap-datetimepicker-4.7.14.js"></script>

<link rel="stylesheet" href="\..\javascripts\new\bootstrap-datetimepicker-4.7.14.css">

	<!-- Angular--> 
	<script src="\..\javascripts\angular.min.js"></script>
	
	
    </head>
	
    <body ng-app ng-controller = "ControllerAngular">

    <div id="menuDiv"></div>

    <!--
    <nav class="navbar navbar-default" style="background-color:#60161E;">
    <div class="container-fluid">
    <!-- REsponsive ->
    <div class="navbar-header" >
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
  <IMG SRC="../images/situn2.png" WIDTH=85 HEIGHT=58  class="nav navbar-nav navbar-right">
    </div>

    <!-- Menu ->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav" style="margin-top:7px;">
        <li ><a href="../HTML/Ingreso de Correspondencia"style="color:#FFFFFF;"><b>Ingreso Correspondencia</b> </a></li>
        <li><a href="../HTML/Enlace de Documentos"style="color:#FFFFFF;"><b>Enlace Documentos</b></a></li>
        <li><a href="#"style="color:#FFFFFF;"><b>Búsqueda</b></a></li>
		<li><a href="#"style="color:#FFFFFF;"><b>Reportes</b></a></li>
		<!---li><a href="#"style="color:#FFFFFF;">Escanear</a></li->
			<li><a href="../HTML/ingresaUser"style="color:#FFFFFF;"><b>Agregar Usuario</b></a></li>
		<li><a href="../HTML/BusquedaUsuarios"style="color:#FFFFFF;"><b>Buscar Usuarios</b></a></li>
		 <li><a href="../logout"style="color:#FFFFFF;"><b>Cerrar sesion</b></a></li>
	    <li><a href="#" style="color:#FFFFFF;"><b>Ayuda</b></a></li>
      </ul>
    
        <IMG SRC="../images/situn2.png" WIDTH=85 HEIGHT=58  class="nav navbar-nav navbar-right">
    </div><!-- /.navbar-collapse ->
  </div><!-- /.container-fluid ->
</nav>
	  -->
	  
	  
	  
	  	<!-- Trigger the modal with a button -->
<!-- Modal -->
<div id="myAyuda" class="modal fade" role="dialog" style="margin: 0 auto; width:675px; height:500px;">
  <div class="well">
   
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="text-danger">Ayuda</h4>
      </div>
      <div class="modal-body">
		<right>
                <tbody>
				Busqueda de Correspondencia:<p>
					Para buscar una correspondencia se deberá escribir en el espacio correspondiente
					el asunto, numero de oficio, destinatario o remitente de la correspondencia, esto 
					dependiendo del criterio de busqueda que selecciono y presionar el botón Buscar.
					Las correspondencias que estarán relacionadas apareceran en el cuadro que se 
					muestra en la página.<p>
					
				Ver Enlaces:<p>	
					En este apartado tambien podrá ver los enlaces que tienen las correspondencias
					presionando el botón Ver Enlaces de cada correspondencia.	
				</tbody> 
	       </right>
		
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button></center>	
      </div>
    </div>

  </div>
  </div>  <!-- fin del popup de ayuda --> 
	   <!---Cuerpo-->
	   <body background="../images/situn4.png">
	   

	
	
	   <div class="col-md-8" style="margin-left:20px">
         <span class="text-danger"><h2>Tipo de Busqueda</h2></span>
 
           <form class="navbar-form navbar-left">         
        
            <div   class="form-group ">
				<select class="form-control input-sm" id="opBusqueda" ng-model = "criterio">
					<option value="Nº oficio">Nº Oficio
					<option value="Destinatorio">Destinatorio                                            
					<option value="Remitente">Remitente                                          
					<option value="Asunto">Asunto                                      
				</select> 
               
          
				<input type="text" class="form45" id="buscar"  >
				<input type = "button" class="btn btn-default" id="buscar" value = "Buscar" ng-click="buscar()" >
				<input type = "button"class="btn btn-default" id ="cancelar" value = "Cancelar"  ng-click="clear()" >
            
			</div>
         <p align="left"><p align="left"><div class="table table-bordered" >
	<p align="left"><table class="table" id="tabla_busqueda">
	
		

		<thead> 
			<tr class="danger">
			<td># Oficio</td>
			<td>Fecha Oficio</td>
			<td>Fecha Recibido</td>
			<td>Asunto</td>
			<td>Destinatario </td>
			<td>Copia</td>
			<td>Remitente</td>			
			<td>Recibido</td>
			<td>Estado</td>
			<td>Enlaces</td>
			<td>Edicion</td>
			<td>Alarma</td>
			<td>Documento</td>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat = "c in correspondencias">
					<td> {{c.tc_3 }} </td>
					<td> {{c.tc_4 | date:'dd/MM/yyyy'}} </td>
					<td> {{c.tc_2 | date:'dd/MM/yyyy'}} </td>
					<td> {{c.tc_8 }} </td>
					<td> {{c.tc_5 }} </td>
					<td> {{c.tc_6 }} </td>
					<td> {{c.tc_7 }} </td>					
					<td> {{c.tc_9 }} </td>
					<td> {{c.tc_10 }} </td>
					<td> 
						<!-- Trigger the modal with a button -->
						<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal" ng-click="obtenerEnlaces(c)">Ver Enlaces</button>
					</td>
					<td> 
						<!-- Trigger the modal with a button -->
						<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal2" ng-click="obtenerInformacion(c)">Editar</button>
					</td>
					<td> 
						<!-- Trigger the modal with a button -->
						<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#myModal3" ng-click="">Ajustar</button>
					</td>
					<td>
					
					<a ng-href="http://localhost:3000/Adjunto/{{c.tc_12}}" target="_blank">Ver</a>	<!-- TERMINAR	-->		
					</td>
			</tr>
		</tbody>        
	</table>
               </div></p>
      </form>
           
   
	   </div>
	  
	  <!-- popup editar correspondencia-->
	<!-- Trigger the modal with a button -->
<!-- Modal -->
<div class="col-md-1"></div>
	   
<div id="myModal2" class="modal fade" role="dialog">
  <div class="modal-dialog">
   
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
	 
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="text-danger">Edición</h4>
      </div>
	  <center>
      <table id ="tablaIC">
                <tbody>
						<tr><span class="add-on"><i  data-date-icon="icon-calendar" onclick="MIC_20(1)"></i></span> 
                     <td> <label class="text-danger">Fecha Recibido</label></td>
                    <td> <div id="datetimepicker4" class="input-append form-group"><input class="form-control"id="IC1" data-format="dd-MM-yyyy" type="text" onfocus="MIC_20(1)" > <!--****** NUEVO ***********-->
					
					<span class="add-on"><i  data-date-icon="icon-calendar" onclick="MIC_20(1)"></i></span> 
					</div>
					</td>
                </tr>
                <tr>
                    <td> <label class="text-danger">N° Oficio</label> </td>
                    <td><div  id="div2"class="form-group"><textarea  id="IC2" type="text" class="form-control" onfocus="MIC_20(2)"></textarea>
					<label class="text-danger" style=""><input  type="checkbox" id="IC12" value="first_checkbox" onchange="MIC_21()">Sin Oficio</label></div></td>           
					</tr>
                <tr>
                    <td> <label class="text-danger">Fecha Oficio</label></td>
                    <td> <div id="datetimepicker3" class="input-append form-group"><input class="form-control"id="IC3" data-format="dd-MM-yyyy" type="text" onfocus="MIC_20(3)" > <!--****** NUEVO ***********-->
					<span class="add-on"><i  data-date-icon="icon-calendar" onclick="MIC_20(3)"></i></span> 
					</div>
					</td>
                </tr>
                <tr>
                    <td> <label class="text-danger">Destinatario </label></td>
                    <td><div id="div4" class="form-group"><textarea id="IC4" type="text" class="form-control"  onfocus="MIC_20(4)"></textarea></div></td> 
                </tr>
				 <tr>
                    <td> <label class="text-danger">Copia </label></td>
                    <td><div id="div5" class="form-group"><textarea id="IC5" type="text" class="form-control" onfocus="MIC_20(5)"></textarea></div></td> 
                </tr>
				 <tr>
                    <td> <label class="text-danger">Remitente </label></td>
                    <td><div id="div6" class="form-group"><textarea id="IC6" type="text" class="form-control" onfocus="MIC_20(6)"></textarea></div></td>                </tr>
                <tr>
                    <td> <label class="text-danger">Asunto</label></td>
                    <td><div id="div7"class="form-group"><textarea id="IC7" type="text" class="form-control"rows=4 cols=30 onfocus="MIC_20(7)"></textarea></input></div></td> <!--****** NUEVO ***********-->
                </tr>
				<tr>
                    <td> <label class="text-danger">Recibido</label></td>
                    <td><div id="div8"class="form-group"><input id="IC8" type="text"class="form-control" onfocus="MIC_20(8)" ng-model="usuario" disabled></input> <div></td> <!--****** NUEVO ***********-->
                </tr>
				<tr>
                    <td> <label class="text-danger">Estado</label></td>
                    <td><div id="div9"class="form-group"><textarea type="text" class="form-control" id="IC9"  onfocus="MIC_20(9)"></textarea></div></td> <!--****** NUEVO ***********-->
                </tr>
                <tr>
                    <td> <label class="text-danger">Observaciones</label></td>
                    <td><div id="div10"class="form-group"><textarea type="text"class="form-control" id="IC10" data-toggle="tooltip" data-placement="right" title="Hooray!"> </textarea></input></div></td> <!--****** NUEVO ***********-->
                </tr>
                </center>
						</tbody>
		           </table>  
      <div class="modal-footer">
	    <center><button type="button" class="btn btn-default" ng-click = "actualiza()" >Guardar</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button></center>	
      </div>
	  
	  
	  
	  
	  
	  
    </div>
	

  </div>
  </div>
</div>
	
	<!-- fin del popup editar correspondencia-->
	  

	  <!-- Trigger the modal with a button -->
<!-- Modal -->
<div class="col-md-1"></div>
	   
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">   
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
      	<button type="button" class="close" data-dismiss="modal">&times;</button>
		<center>
			<h4>Mostrando Enlaces de </h4>
			<h4 id="idEnlace"></h4>
		</center>
      </div>
      <div class="modal-body">
		<center>
			<table class="table">
			<thead>
			<tr class="danger">
				<td>
					<h3>Superiores</h3>
				<td>
					<h3>Inferiores</h3>
				<td>
					
				</td>
			</tr>
			</thead>
			<tbody>
				<tr>
					<td>
						<div>
							<li ng-repeat = "e in enlaces[0]">{{e}}</li>
						</div>
					</td>
					<td>
						<div>
							<li ng-repeat = "e in enlaces[1]">{{e}}</li>
						</div>
					</td>
				</tr>
			</tbody>
		</table> 
		</center>
		 
		
		
      </div>
      <div class="modal-footer">
	    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
  </div>
</div>

<!-- popup alarma-->
		   	    <!-- Modal -->
<!-- Modal -->
<div ></div>
	   
<div id="myModal3" class="modal fade" role="dialog">
  <div class="modal-dialog">
   
    <!-- Modal content-->
   
	 <div class="modal-content">
      <div class="modal-header">		
        <button type="button" class="close" data-dismiss="modal">&times;</button>
		<center>
			<h4>Ajuste de Alarma </h4>
			
		</center>
	  </div>
      <div class="modal-body">
	  <center>
		<table class="table">
			<thead>
			<tr class="danger">
				<td>
					 <label class="text-danger">Fecha Aviso</label>
				<td>
				<!--
					<div id="datetimepicker5" class="input-append form-group"><input class="form-control"id="IC14" data-format="dd-MM-yyyy" type="text" onfocus="MIC_20(3)" > <!--****** NUEVO ***********->
					<span class="add-on"><i  data-date-icon="icon-calendar" onclick="MIC_20(3)"></i></span> 
					</div>
					-->
					
					<div class='input-group date' id='datetimepicker33'>
          					<input type='text' class="form-control" id="IC14"/>
          					<span class="input-group-addon">
            					<span class="glyphicon glyphicon-calendar" onclick="MIC_20(3)"></span>
          					</span>
        				</div>

				<td>
					
				</td>
			</tr>
			<tr class="danger">
				<td>
					 <label class="text-danger">Fecha Limite</label>
				<td>
				<!--
					<div id="datetimepicker5" class="input-append form-group"><input class="form-control"id="IC14" data-format="dd-MM-yyyy" type="text" onfocus="MIC_20(3)" > <!--****** NUEVO ***********->
					<span class="add-on"><i  data-date-icon="icon-calendar" onclick="MIC_20(3)"></i></span> 
					</div>
					-->
					<div class='input-group date' id='datetimepicker44'>
          					<input type='text' class="form-control" id="IC14"/>
          					<span class="input-group-addon">
            					<span class="glyphicon glyphicon-calendar" onclick="MIC_20(3)"></span>
          					</span>
        				</div>
				<td>
					
				</td>
			</tr>
			</thead>
			
		</table>
		</center>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
  </div>

	


	<!-- fin del popup Alarma-->

	  
	   
<script type="text/javascript">
  

$(document).ready(function() {
    // Solicita la informacion de la sesion si aun no existe en el storage
	$("#menuDiv").load("/HTML/menu");
		$("#ayuda").click(
	function(){
		$("#miAyuda").show();
	});

});



let app = angular.module('app', []);
function MB_01($scope)//ControllerAngular
 {
	$scope.criterio = "Asunto";
	$scope.correspondencias = new Array();
	$scope.updateCorrespondencias = c => $scope.correspondencias = c;
	$scope.buscar = _ => MB_02($scope);
	$scope.clear = _ => MB_05($scope);
	$scope.obtenerEnlaces	= n => MB_06($scope, n);
	$scope.enlaces = new Array();
    $scope.obtenerInformacion	= e => asignarInformacion($scope, e);
	$scope.recibido = r => ObtenerRecibido();
	$scope.actualiza =_ => actualizarInfo($scope);
  }
  
   app.controller('ControllerAngular', MB_01); 
 
 function MB_06($scope, cor)
 {	
	 fetch( 'http://localhost:3000/api/ALL/ENLACES', {  
    method: 'POST', 
    datatype:'json',
    headers: {  
      "Content-type": "application/x-www-form-urlencoded"  
      } ,
    body: "COD=" + cor.tc_1
      }
	)	 
	.then(res => res.json())
	.then(obj => ( $scope.$apply( _=>
						$scope.enlaces = obj.data),
					$("#idEnlace").text(cor.tc_3) 
				)
			)
	.catch(err => console.log('Request failed', err));
 }
 
 
 let conditional;
  function asignarInformacion($scope, cor)
 {	//desactivar();
   //limpiarValores();  
  
   conditional=cor.tc_1;
   console.log("asigna"+cor.tc_1);
	 fetch( 'http://localhost:3000/api/TC/BC', {  
    method: 'POST', 
    datatype:'json',
    headers: {  
      "Content-type": "application/x-www-form-urlencoded"  
      } ,
    body: "TC_1=" + cor.tc_1
      }
	)	 
	.then(res => res.json())
	.then(obj => cargarDatos( obj.data[0])
			)
	.catch(err => console.log('Request failed', err));
 }
 let person;
  function cargarDatos( data){
 
  let fechaO=  new Date(data.tc_2.substr(0, 4),data.tc_2.substr(5, 2),data.tc_2.substr(8, 2));
  let fechaOficio=(data.tc_2.substr(8, 2)+"-"+data.tc_2.substr(5, 2)+"-"+data.tc_2.substr(0, 4));
  console.log(fechaOficio);
     $("#IC1").val(fechaOficio);
     $("#IC2").val(data.tc_3);
  
  let fechaR=  new Date(data.tc_4.substr(0, 4),data.tc_4.substr(5, 2),data.tc_4.substr(8, 2));
  let fechaRecibido=(data.tc_4.substr(8, 2)+"-"+data.tc_4.substr(5, 2)+"-"+data.tc_4.substr(0, 4));
  
     $("#IC3").val(fechaRecibido);
	 $("#IC4").val(data.tc_5);
	 $("#IC5").val(data.tc_6);
	 $("#IC6").val(data.tc_7);
     $("#IC7").val(data.tc_8);
	 person=data.tc_9;
     ObtenerRecibido();
	 $("#IC9").val(data.tc_10);
	 $("#IC10").val(data.tc_11);
	
	 
	

 }
 //------------------------------------------
 
 function ObtenerRecibido()
 {	//desactivar();
   //limpiarValores();
   //conditional=cor.tc_1;
  console.log("Person"+person);
	 fetch( 'http://localhost:3000/api/TP/B', {  
    method: 'POST', 
    datatype:'json',
    headers: {  
      "Content-type": "application/x-www-form-urlencoded"  
      } ,
    body: "TP_4=" + person
      }
	)	 
	.then(res => res.json())
	.then(obj => cargarRecibido(obj.data[0])
			)
	.catch(err => console.log('Request failed', err));
 }
 
 
  function cargarRecibido(data){
      $("#IC8").val(data.tp_1+" "+data.tp_2+" "+data.tp_3);
     
  
	

 }
 

 
 
 function MB_02($scope)  //Metodo de Busqueda
 {
 	console.log("Retornado de url > " + MB_03($scope));
	let h3 = document.getElementById('buscar').value;
	 fetch( 'http://localhost:3000/api/TC/'+MB_03($scope), {  
    method: 'POST', 
    datatype:'json',
    headers: {  
      "Content-type": "application/x-www-form-urlencoded"  
      } ,
    body: MB_04($scope) + "=" + h3
      }
	)	 
	.then(res => res.json())
	.then(obj => $scope.$apply( _=>
					$scope.updateCorrespondencias(obj.data)))
	.catch(err => console.log('Request failed', err));
 }
 
 
function MB_03($scope)// Toma el tipo de busqueda y regresa el sufijo correspondiente a la dirección del servidor
{
	let op = $scope.criterio;
	console.log("El tipo de busqueda es por: |" + op + "|");
	switch(op)
	{
		case 'Nº oficio': // Oficio
			return 'BO';
		case 'Destinatorio': // Destinatario
			return 'BD';
		case 'Remitente': // Remitente
			return 'BR';
		case 'Asunto': // Asunto
			return 'BA';
	}
}  
function MB_04($scope) //Toma el criterio de busqueda y devuelve la columna que se debe buscar en la BD
{
	let op = $scope.criterio;
	switch(op)
	{
		case 'Nº oficio': // Oficio
			return 'TC_3';
		case 'Destinatorio': // Destinatario
			return 'TC_5';
		case 'Remitente': // Remitente
			return 'TC_7';
		case 'Asunto': // Asunto
			return 'TC_8';
	}
	
} 

function MB_05($scope){// limpia el div con el id de buscar
	$("#buscar").val("");
	$scope.correspondencias = new Array();
	} 
	
	
	
	//----nuevos
	 function MIC_20(n){//Limpia los campos cuando se enfocan
 //document.getElementById("IC11").disabled=true;
  MIC_19();
  MIC_04(n);
 }
 
 function MIC_19(){//Limpia el div con el id=mensaje
$("#mensaje").text("");
}

function MIC_04(op){//Realiza un cambio de clase a los campos de entrada del formulario de la clase has-error a from-group
	switch(op){
	case 1: document.getElementById("datetimepicker4").className= "input-append form-group";break;
	case 2: document.getElementById("div2").className ="form-group" ; break;
	case 3: document.getElementById("datetimepicker3").className ="input-append  form-group" ; break;
	case 4: document.getElementById("div4").className ="  form-group" ;break;
	case 5: document.getElementById("div5").className ="  form-group" ;break;
	case 6: document.getElementById("div6").className ="  form-group" ;break;
	case 7: document.getElementById("div7").className ="  form-group" ;break;
	case 8: document.getElementById("div8").className ="  form-group" ;break;
	case 9: document.getElementById("div9").className ="  form-group" ;break;
	//case 10: document.getElementById("div10").className ="  form-group" ;break
	
	default: break;
	}
	}
	
	    function actualizarInfo($scope){
  console.log('validacion '+validar());
    if(validar()){
	console.log('Entro despues de validacion'+validar()); // Quitar
	actualizarCorre($scope);
	
    MB_02($scope);
	$("[data-dismiss=modal]").trigger({ type: "click" });
	
	}
  }
  
  function MIC_21(){ //Cambia el valor del campo referente al numero de oficio si la opcion SIN OFICIO esta marcada
if($("#IC12").is(':checked')){
	$("#IC2").val("SIN OFICIO");
	$("#IC2").prop("disabled",true);	
	}
	else{
	$("#IC2").val("");
	$("#IC2").prop("disabled",false);
	}
}
  
  function validar(){	 //Valida los campos 
	IC1 = true;
	IC2 = true;
	IC3 = true;
	IC4	= true;
	IC5 = true;
	IC6 = true;
	IC7 = true;
	IC8 = true;
	IC9 = true;
	IC10 = true;
	
	if($("#IC1").val().length == 0){
		document.getElementById("datetimepicker4").className ="input-append  form-group has-error" ;
		document.getElementById("IC1").title = "Campo Obligatoria" ;
		IC1 = false;
	}
	else{
	document.getElementById("datetimepicker4").className ="input-append  form-group" ;
	document.getElementById("IC1").title = "" ;
	}
	if($("#IC2").val().length == 0){
		document.getElementById("div2").className = "form-group has-error" ;
		document.getElementById("IC2").title = "Campo Obligatorio";
		IC2 = false;
	}
	else{
	document.getElementById("div2").className ="  form-group" ;
	document.getElementById("IC2").title = "" ;
	}
	
	if($("#IC3").val().length == 0){
		document.getElementById("datetimepicker3").className = " input-append  form-group has-error" ;
		document.getElementById("IC3").title = "Campo Obligatorio";
		IC3 = false;
	}
	else{
	document.getElementById("datetimepicker3").className ="input-append  form-group" ;
	document.getElementById("IC3").title = "" ;
	}
	if($("#IC4").val().length == 0){
		document.getElementById("div4").className ="form-group has-error" ;
		document.getElementById("IC4").title = "Campo Obligatorio";
		IC4 = false;
	}
	else{
	document.getElementById("div4").className =" form-group" ;
	document.getElementById("IC4").title = "" ;
	}
	if($("#IC5").val().length == 0){
		document.getElementById("div5").className = "form-group has-error" ;
		document.getElementById("IC5").title = "Campo Obligatorio";
		IC5 = false;
	}
	else{
	document.getElementById("div5").className ="  form-group" ;
	document.getElementById("IC5").title = "" ;
	}
	if($("#IC6").val().length == 0){
		document.getElementById("div6").className = "form-group has-error" ;
		document.getElementById("IC6").title = "Campo Obligatorio";
		IC6 = false;
	}
	else{
	document.getElementById("div6").className ="  form-group" ;
	document.getElementById("IC6").title = "" ;
	}
	if($("#IC7").val().length == 0){
		document.getElementById("div7").className = "form-group has-error" ;
		document.getElementById("IC7").title = "Campo Obligatorio";
		IC7 = false;
	}
	else{
	document.getElementById("div7").className ="form-group" ;
	document.getElementById("IC7").title = "" ;
	}
	if($("#IC8").val().length == 0){
		document.getElementById("div8").className = "form-group has-error" ;
		document.getElementById("IC8").title = "Campo Obligatorio";
		IC8 = false;
	}
	else{
	document.getElementById("div8").className ="  form-group" ;
	document.getElementById("IC8").title = "" ;
	}
	if($("#IC9").val().length == 0){
		document.getElementById("div9").className ="form-group has-error" ;
		document.getElementById("IC9").title = "Campo Obligatorio";
		IC9 = false;
	}
	else{
	document.getElementById("div9").className ="  form-group" ;
	document.getElementById("IC9").title = "" ;
	}
	
		
		return (IC1 && IC2  && IC3  && IC4 	&& IC5 && IC6 && IC7 && IC8 && IC9 && MIC_05());
	
}



function MIC_05(){//Realiza el cambio de clase de los campon de fecha del formulario a la clase has-error

	
	
	var d=new Date($("#IC1").val());
	let fecha1 = d.getFullYear() + '-'+(d.getMonth()+1) + '-' + ((d.getDate()<10)?'0':'') + d.getDate();
	let fecha2=$("#IC3").val();
	//La fecha debe de llevar el formato YYYY/MM/dd
	
	let r=fecha2.substring(10, 6)+'-'+fecha2.substring(5, 3)+'-'+fecha2.substring(2, 0);
	if(fecha1>=r){
	document.getElementById("datetimepicker4").className ="input-append  form-group " ;
	document.getElementById("IC1").title = "" ;
	document.getElementById("datetimepicker3").className ="input-append  form-group " ;
	document.getElementById("IC3").title = "" ;
	return true;}
	else{
	document.getElementById("datetimepicker4").className ="input-append  form-group has-error" ;
	document.getElementById("IC1").title = "Fecha de oficio mayor a la de recibido" ;
	document.getElementById("datetimepicker3").className ="input-append  form-group has-error" ;
		document.getElementById("IC3").title = "Fecha de oficio mayor a la de recibido" ;
	return false;}
	}
	
	
	function actualizarCorre($scope,cor){ //Recoge los datos de los campos y realiza el fecth de inserción 
							//a la base de datos
							//let str=$("#IC1").val();
	var d=new Date($("#IC1").val());
	
	let a1=conditional;

	
	let b3 = $("#IC1").val().substr(6,4)+"-"+$("#IC1").val().substr(3,2)+"-"+$("#IC1").val().substr(0,2);
	console.log("anooo "+b3);
	let c3 = $('#IC2').val().toUpperCase(); 
	let fecha=$('#IC3').val();
	let d3 = $("#IC3").val().substr(6,4)+"-"+$("#IC3").val().substr(3,2)+"-"+$("#IC3").val().substr(0,2);
	let e3 = $('#IC4').val().toUpperCase();
	let f3 = $('#IC5').val().toUpperCase();
	let g3 = $('#IC6').val().toUpperCase();
	let h3 = $('#IC7').val().toUpperCase();
	let i3 = '1'; // cambiar solo lo puse por que si no mamaron al ingresar
	let j3 = $('#IC9').val().toUpperCase();
    let k3 = $('#IC10').val().toUpperCase();

 fetch( 'http://localhost:3000/api/TC/UD', {  
    method: 'POST', 
    datatype:'json',
    headers: {  
      "Content-type": "application/x-www-form-urlencoded"  
      } ,
    body: "TC_1="+ a1+"&TC_2="+ b3+ "&TC_3="+c3+
	"&TC_4="+ d3 + "&TC_5="+ e3 +"&TC_6="+ f3 + 
	"&TC_7="+ g3 + "&TC_8="+ h3 +"&TC_9="+ i3+"&TC_10="+ j3+ "&TC_11="+ k3
      }
	  )
  .then(function(response) {
		return response.text().then(function(res) {
				console.log("Resultado: "+res);
					if(res.indexOf("error")==-1){
						$("#mensaje").text("Acción realizada con exito");
							//MIC_13($scope); 
							//document.getElementById("IC11").disabled=true; //VER
							//console.log($("#enlace_checkbox").is(':checked'));
							/*if($("#enlace_checkbox").is(':checked'))
							{
								MIC_06();
							}*/
					}
					else{}
						//document.getElementById("mensaje").innerHTML="Fallo al realizar la acción";
				});
	})
  .catch(function(error) {  
   console.log('Request failed', error);  
  });
 
}


/**
* Funciones de los calendarios de la pagina
**/


 // $(function() {     //Calendario de la fecha de oficio
    $('#datetimepicker33').datetimepicker({
      //pickTime: false
      format: 'DD-MM-YYYY', 
   		showClear:true
    });
  //});
  
  // $(function() { //Calendario de la fecha de recibido
    $('#datetimepicker44').datetimepicker({
      //pickTime: false
      format: 'DD-MM-YYYY', 
   		showClear:true
    });
 // });

   
</script>
    </body>
</html>